require("../../config/config").config("bf");
const { removeCatFromProduct } = require("../../functions/products/removeCatFromProduct");
/**
 * issue with this script is that its prematurely returning an empty array and not the expected output from promise allsettled
 */

/**
 * This needs to be tested before using
 * @param {*} productIds
 * @param {*} categoryName
 * @returns
 */
const removeCategoryFromSpecificProducts = (productIds, categoryId) =>
  new Promise((resolve, reject) => {
    let promises = [];
    productIds.forEach((productId) => {
      let id = productId[Object.keys(productId)[0]];
      promises.push(removeCatFromProduct(id, categoryId));
    });
    Promise.allSettled(promises).then(resolve).catch(reject);
  });
const productIds = [{"Product ID":4178},
{"Product ID":4216},
{"Product ID":4333},
{"Product ID":4433},
{"Product ID":4435},
{"Product ID":4507},
{"Product ID":4508},
{"Product ID":3506},
{"Product ID":3507},
{"Product ID":4294},
{"Product ID":4295},
{"Product ID":4509},
{"Product ID":4510},
{"Product ID":4513},
{"Product ID":3508},
{"Product ID":3509},
{"Product ID":4276},
{"Product ID":4514},
{"Product ID":3510},
{"Product ID":3511},
{"Product ID":4274},
{"Product ID":4515},
{"Product ID":3512},
{"Product ID":3513},
{"Product ID":4284},
{"Product ID":4516},
{"Product ID":3514},
{"Product ID":3515},
{"Product ID":4283},
{"Product ID":4517},
{"Product ID":3516},
{"Product ID":3517},
{"Product ID":4279},
{"Product ID":4292},
{"Product ID":4743},
{"Product ID":4745},
{"Product ID":5380},
{"Product ID":5381},
{"Product ID":5382},
{"Product ID":5383},
{"Product ID":5384},
{"Product ID":5385},
{"Product ID":5386},
{"Product ID":5387},
{"Product ID":5388},
{"Product ID":5389},
{"Product ID":5390},
{"Product ID":5391},
{"Product ID":5392},
{"Product ID":5446},
{"Product ID":3706},
{"Product ID":3707},
{"Product ID":5207},
{"Product ID":5447},
{"Product ID":3708},
{"Product ID":3709},
{"Product ID":3710},
{"Product ID":5208},
{"Product ID":5209},
{"Product ID":5448},
{"Product ID":3711},
{"Product ID":3712},
{"Product ID":5210},
{"Product ID":5449},
{"Product ID":3713},
{"Product ID":3714},
{"Product ID":3715},
{"Product ID":5211},
{"Product ID":5212},
{"Product ID":5450},
{"Product ID":3716},
{"Product ID":3717},
{"Product ID":5213},
{"Product ID":5451},
{"Product ID":3718},
{"Product ID":3719},
{"Product ID":5214},
{"Product ID":5452},
{"Product ID":3720},
{"Product ID":3721},
{"Product ID":5215},
{"Product ID":5453},
{"Product ID":3722},
{"Product ID":3723},
{"Product ID":5216},
{"Product ID":5454},
{"Product ID":3724},
{"Product ID":3725},
{"Product ID":5217},
{"Product ID":5455},
{"Product ID":3726},
{"Product ID":3727},
{"Product ID":3728},
{"Product ID":5218},
{"Product ID":5219},
{"Product ID":5456},
{"Product ID":3729},
{"Product ID":3730},
{"Product ID":3731},
{"Product ID":5220},
{"Product ID":5221},
{"Product ID":5457},
{"Product ID":3732},
{"Product ID":3733},
{"Product ID":3734},
{"Product ID":5222},
{"Product ID":5223},
{"Product ID":5458},
{"Product ID":3735},
{"Product ID":3736},
{"Product ID":3737},
{"Product ID":5224},
{"Product ID":5225},
{"Product ID":5459},
{"Product ID":3738},
{"Product ID":3739},
{"Product ID":3740},
{"Product ID":5226},
{"Product ID":5227},
{"Product ID":5460},
{"Product ID":3741},
{"Product ID":3742},
{"Product ID":5228},
{"Product ID":5461},
{"Product ID":3743},
{"Product ID":3744},
{"Product ID":5229},
{"Product ID":5462},
{"Product ID":5463},
{"Product ID":5464},
{"Product ID":5466},
{"Product ID":5467},
{"Product ID":5468},
{"Product ID":5469},
{"Product ID":5470},
{"Product ID":3745},
{"Product ID":3746},
{"Product ID":5230},
{"Product ID":5471},
{"Product ID":5472},
{"Product ID":5473},
{"Product ID":5474},
{"Product ID":3747},
{"Product ID":3748},
{"Product ID":5231},
{"Product ID":5475},
{"Product ID":5476},
{"Product ID":5477},
{"Product ID":5478},
{"Product ID":5479},
{"Product ID":5480},
{"Product ID":5481},
{"Product ID":5482},
{"Product ID":5483},
{"Product ID":3749},
{"Product ID":3750},
{"Product ID":5232},
{"Product ID":5484},
{"Product ID":5485},
{"Product ID":5486}]
const catId = 624;
removeCategoryFromSpecificProducts(productIds, catId)
  .then((res) =>
    console.log("removeCategoryFromSpecificProducts response", res)
  )
  .catch((err) => console.log(err));
